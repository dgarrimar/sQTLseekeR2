geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value)) +
theme(legend.title=element_blank())
plot_grid(g12, g13, g14, g15, ncol=2)
g17 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
g17
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),
aes(RES.o.shape1, RES.1o.shape1
color=RES.o.shape1))
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1, color=RES.o.shape1))
RES.o$shape1
RES.1o$shape1
colnames(RES.1)
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1, color=RES.o.shape1))
geom_jitter() +
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1, color=RES.o.shape1))
geom_jitter()
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1, color=RES.o.shape1)) +
geom_jitter()
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_vline(xintercept=seq(0, 1.4, by=0.1),col="gray95")+
geom_hline(yintercept=seq(0, 1.4, by=0.1),col="gray95")+
geom_vline(xintercept=seq(0, 1.4, by=0.2),col="gray90")+
geom_hline(yintercept=seq(0, 1.4, by=0.2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))
g15
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_vline(xintercept=seq(0.4, 1.4, by=0.1),col="gray95")+
geom_hline(yintercept=seq(0.4, 1.4, by=0.1),col="gray95")+
geom_vline(xintercept=seq(0.4, 1.4, by=0.2),col="gray90")+
geom_hline(yintercept=seq(0.4, 1.4, by=0.2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0.4,1.4,0.2))+
scale_y_continuous(breaks = seq(0.4,1.4,0.2))
g15
ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2))
geom_jitter()
ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g17 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
g17
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.1000.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("shape1") + xlab("Number of variants in cis") + ylab("time (h)")
g15 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g16 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g17 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g18 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g12, g13, g14, g15, g16, g17, g18, ncol=2)
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.1000.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("shape1") + xlab("Number of variants in cis") + ylab("time (h)")
g15 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g16 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g17 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g18 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g12, g13, g14, g15, g16, g17, g18, ncol=2)
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.1000.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
plot_grid(g12, g13, g14, g15, g16, g17, ncol=2)
g17 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g12, g13, g14, g15, g16, g17, ncol=2)
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.o<-RES[order(RES$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime/60, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (h)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
plot_grid(g12, g13, g14, g15, g16, g17, ncol=2)
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES.1<-subset(RES.1, nb.perms ==1000)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g17 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g12 <-ggplot(RES.1,aes(variants.cis,runtime, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g13 <-ggplot(RES.1,aes(variants.cis,runtime, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g14 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==200)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g15 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g16 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g17 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g12, g13, g14, g15, g16, g17, ncol=2)
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g18 <-ggplot(RES.1,aes(variants.cis,runtime, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g19 <-ggplot(RES.1,aes(variants.cis,runtime, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g20 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==200)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g21 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g22 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g23 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g18, g19, g20, g21, g22, g23, ncol=2)
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
RES.1 <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.200.tsv",h=F)
colnames(RES.1)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
g18 <-ggplot(RES.1,aes(variants.cis,runtime, color=pv.emp.beta)) + geom_jitter() +
ggtitle("Runing time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "tomato",high="darkgreen")
g19 <-ggplot(RES.1,aes(variants.cis,runtime, color=nb.perms)) + geom_jitter() +
ggtitle("Running time") + xlab("Number of variants in cis") + ylab("time (min)") +
scale_color_continuous(low = "darkgreen",high="tomato")
g20 <- ggplot(RES.1,aes(nb.perms)) + geom_density()
RES <- subset(RES,nb.perms ==10000)
RES.1<-subset(RES.1, nb.perms ==200)
RES<-subset(RES,geneId%in%RES.1$geneId)
RES.1<-subset(RES.1, geneId%in%RES$geneId)
RES.o<-RES[order(RES$geneId),]
RES.1o<-RES.1[order(RES.1$geneId),]
g21 <-ggplot(data=data.frame(RES.o$shape1,RES.1o$shape1),aes(RES.o.shape1, RES.1o.shape1,color=RES.o.shape1)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape1") + theme(plot.title = element_text(hjust = 0.5))
g22 <-ggplot(data=data.frame(RES.o$shape2,RES.1o$shape2),aes(RES.o.shape2, RES.1o.shape2,color=RES.o.shape2)) +
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("shape2") + theme(plot.title = element_text(hjust = 0.5))
r <- with(data.frame(RES.o,RES.1o),cor.test(pv.emp,pv.emp.beta))
g23 <-ggplot(data=data.frame(RES.o$pv.emp.beta,RES.1o$pv.emp.beta),
aes(-log10(RES.o.pv.emp.beta),-log10(RES.1o.pv.emp.beta),
color=-log10(RES.o.pv.emp.beta))) +
geom_vline(xintercept=seq(0, 14, by=1),col="gray95")+
geom_hline(yintercept=seq(0, 14, by=1),col="gray95")+
geom_vline(xintercept=seq(0, 14, by=2),col="gray90")+
geom_hline(yintercept=seq(0, 14, by=2),col="gray90")+
geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("10,000 permutations") + ylab("1,000 permutations") +
ggtitle("-log10(Beta pv)") + theme(plot.title = element_text(hjust = 0.5))+
scale_x_continuous(breaks = seq(0,14,2))+
scale_y_continuous(breaks = seq(0,14,2))+
annotate("text",x=10,y=2,label=sprintf("r = %0.5f C.I. 95%% [%0.5f,%0.5f]\nP value = %05.e",
r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
plot_grid(g18, g19, g20, g21, g22, g23, ncol=2)
g1b <-ggplot(RES.o[1:1000,],aes(-log10(pv.emp),-log10(pv.emp.beta), color=shape1)) + geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("-log10 P value (permutation)") + ylab("-log10 P value (Beta)")
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
suppressPackageStartupMessages(library(cowplot))
suppressPackageStartupMessages(library(ggplot2))
g1b <-ggplot(RES.o[1:1000,],aes(-log10(pv.emp),-log10(pv.emp.beta), color=shape1)) + geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("-log10 P value (permutation)") + ylab("-log10 P value (Beta)")
RES.o<-RES[order(RES$pv.emp),]
g1b <-ggplot(RES.o,aes(-log10(pv.emp),-log10(pv.emp.beta), color=shape1)) + geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("-log10 P value (permutation)") + ylab("-log10 P value (Beta)")
RES.o<-RES[order(RES$pv.emp),]
RES <- read.table("~/PhD/projects/sqtlseeker/beta/results/gtex.ovary.sqtlseeker.p.10000.tsv",h=T)
colnames(RES)<-c("geneId","variants.cis", "ld", "best.snp", "best.nominal.pv","shape1", "shape2",
"nb.perms", "pv.emp", "pv.emp.beta","runtime")
weird<-RES[which(RES$shape1 > 2 | RES$shape1 < 0.5),]
with(RES,plot(pv.emp,pv.emp.beta,xlim=c(0,1),ylim=c(0,1),
xlab="P value (permutation)", ylab="P value (Beta approximation)",main="P value (empirical)"))
abline(0,1,col="red")
r<-with(RES,cor.test(pv.emp,pv.emp.beta))
text(x=0.62,y=0.1,sprintf("r=%0.5f C.I. 95%% [%0.5f,%0.5f]\nP value= %05.e",r$estimate,r$conf.int[1],r$conf.int[2],r$p.value))
```{r, echo=FALSE,fig.width=15, fig.height=10}
sup
suppressPackageStartupMessages(library(cowplot))
suppressPackageStartupMessages(library(ggplot2))
RES.o<-RES[order(RES$pv.emp),]
g1b <-ggplot(RES.o,aes(-log10(pv.emp),-log10(pv.emp.beta), color=shape1)) + geom_jitter() +
geom_abline(slope = 1, intercept = 0, col="red") +
xlab("-log10 P value (permutation)") + ylab("-log10 P value (Beta)")
g1b
